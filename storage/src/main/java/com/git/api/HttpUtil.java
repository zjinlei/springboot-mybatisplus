package com.git.api;

import java.io.UnsupportedEncodingException;
import java.net.URI;
import java.util.List;
import java.util.Map;

import com.alibaba.fastjson.JSON;
import com.google.common.reflect.TypeToken;
import com.google.gson.Gson;
import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;

/**
 * @author jimin.jm@alibaba-inc.com
 * @date 2019/12/13
 */
public class HttpUtil {

    public static String sendHttpsGet(String url, Map<String, String> headers, Map<String, String> pmap) {
        HttpClient client = new DefaultHttpClient();
        // 实例化HTTP方法
        HttpGet get = new HttpGet();
        for (String keyh : headers.keySet()) {
            get.setHeader(keyh, headers.get(keyh));
        }
        String params = "";
        for (String keyp : pmap.keySet()) {
            params += "&" + keyp + "=" + pmap.get(keyp);
        }
        url += params.replaceAll("^&", "?");
        String result = "";
        try {
            get.setURI(new URI(url));
            HttpResponse response = client.execute(get);
            result = EntityUtils.toString(response.getEntity());
        } catch (Exception e) {
            // TODO: handle exception
            e.printStackTrace();
        }
        try {
            result = new String(result.getBytes("ISO-8859-1"), "utf-8");
        } catch (UnsupportedEncodingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return result;

    }

    public static void main(String[] args) {
        String str = "[{\"sha\":\"7733dfd1d60b3cc8c32bdabdc28c5b3a3e19b917\",\"node_id\":\"MDY6Q29tbWl0MTYzMzg3MzM3Ojc3MzNkZmQxZDYwYjNjYzhjMzJiZGFiZGMyOGM1YjNhM2UxOWI5MTc=\",\"commit\":{\"author\":{\"name\":\"zhangchenghui\",\"email\":\"zhangchenghui.dev@gmail.com\",\"date\":\"2019-12-13T14:16:24Z\"},\"committer\":{\"name\":\"zjinlei\",\"email\":\"75718677@qq.com\",\"date\":\"2019-12-13T14:16:24Z\"},\"message\":\"bugfix: fix Etcd3Configuration FILE_CONFIG reference incorrect (#2032)\",\"tree\":{\"sha\":\"4321f2374baccf9d94a378841135cf163dd19880\",\"url\":\"https://api.github.com/repos/seata/seata/git/trees/4321f2374baccf9d94a378841135cf163dd19880\"},\"url\":\"https://api.github.com/repos/seata/seata/git/commits/7733dfd1d60b3cc8c32bdabdc28c5b3a3e19b917\",\"comment_count\":0,\"verification\":{\"verified\":false,\"reason\":\"unsigned\",\"signature\":null,\"payload\":null}},\"url\":\"https://api.github.com/repos/seata/seata/commits/7733dfd1d60b3cc8c32bdabdc28c5b3a3e19b917\",\"html_url\":\"https://github.com/seata/seata/commit/7733dfd1d60b3cc8c32bdabdc28c5b3a3e19b917\",\"comments_url\":\"https://api.github.com/repos/seata/seata/commits/7733dfd1d60b3cc8c32bdabdc28c5b3a3e19b917/comments\",\"author\":{\"login\":\"objcoding\",\"id\":24354760,\"node_id\":\"MDQ6VXNlcjI0MzU0NzYw\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/24354760?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/objcoding\",\"html_url\":\"https://github.com/objcoding\",\"followers_url\":\"https://api.github.com/users/objcoding/followers\",\"following_url\":\"https://api.github.com/users/objcoding/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/objcoding/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/objcoding/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/objcoding/subscriptions\",\"organizations_url\":\"https://api.github.com/users/objcoding/orgs\",\"repos_url\":\"https://api.github.com/users/objcoding/repos\",\"events_url\":\"https://api.github.com/users/objcoding/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/objcoding/received_events\",\"type\":\"User\",\"site_admin\":false},\"committer\":{\"login\":\"zjinlei\",\"id\":20024955,\"node_id\":\"MDQ6VXNlcjIwMDI0OTU1\",\"avatar_url\":\"https://avatars3.githubusercontent.com/u/20024955?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/zjinlei\",\"html_url\":\"https://github.com/zjinlei\",\"followers_url\":\"https://api.github.com/users/zjinlei/followers\",\"following_url\":\"https://api.github.com/users/zjinlei/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/zjinlei/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/zjinlei/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/zjinlei/subscriptions\",\"organizations_url\":\"https://api.github.com/users/zjinlei/orgs\",\"repos_url\":\"https://api.github.com/users/zjinlei/repos\",\"events_url\":\"https://api.github.com/users/zjinlei/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/zjinlei/received_events\",\"type\":\"User\",\"site_admin\":false},\"parents\":[{\"sha\":\"016277103857baee6d27108caad57f9e4f3d9703\",\"url\":\"https://api.github.com/repos/seata/seata/commits/016277103857baee6d27108caad57f9e4f3d9703\",\"html_url\":\"https://github.com/seata/seata/commit/016277103857baee6d27108caad57f9e4f3d9703\"}]},{\"sha\":\"016277103857baee6d27108caad57f9e4f3d9703\",\"node_id\":\"MDY6Q29tbWl0MTYzMzg3MzM3OjAxNjI3NzEwMzg1N2JhZWU2ZDI3MTA4Y2FhZDU3ZjllNGYzZDk3MDM=\",\"commit\":{\"author\":{\"name\":\"jimin\",\"email\":\"slievrly@gmail.com\",\"date\":\"2019-12-13T13:38:44Z\"},\"committer\":{\"name\":\"zjinlei\",\"email\":\"75718677@qq.com\",\"date\":\"2019-12-13T13:38:44Z\"},\"message\":\"feature:support dynamic disable (#1992)\",\"tree\":{\"sha\":\"92cea9e7c5c5a081de57d5e686767d4628731159\",\"url\":\"https://api.github.com/repos/seata/seata/git/trees/92cea9e7c5c5a081de57d5e686767d4628731159\"},\"url\":\"https://api.github.com/repos/seata/seata/git/commits/016277103857baee6d27108caad57f9e4f3d9703\",\"comment_count\":0,\"verification\":{\"verified\":false,\"reason\":\"unsigned\",\"signature\":null,\"payload\":null}},\"url\":\"https://api.github.com/repos/seata/seata/commits/016277103857baee6d27108caad57f9e4f3d9703\",\"html_url\":\"https://github.com/seata/seata/commit/016277103857baee6d27108caad57f9e4f3d9703\",\"comments_url\":\"https://api.github.com/repos/seata/seata/commits/016277103857baee6d27108caad57f9e4f3d9703/comments\",\"author\":{\"login\":\"slievrly\",\"id\":8758457,\"node_id\":\"MDQ6VXNlcjg3NTg0NTc=\",\"avatar_url\":\"https://avatars1.githubusercontent.com/u/8758457?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/slievrly\",\"html_url\":\"https://github.com/slievrly\",\"followers_url\":\"https://api.github.com/users/slievrly/followers\",\"following_url\":\"https://api.github.com/users/slievrly/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/slievrly/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/slievrly/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/slievrly/subscriptions\",\"organizations_url\":\"https://api.github.com/users/slievrly/orgs\",\"repos_url\":\"https://api.github.com/users/slievrly/repos\",\"events_url\":\"https://api.github.com/users/slievrly/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/slievrly/received_events\",\"type\":\"User\",\"site_admin\":false},\"committer\":{\"login\":\"zjinlei\",\"id\":20024955,\"node_id\":\"MDQ6VXNlcjIwMDI0OTU1\",\"avatar_url\":\"https://avatars3.githubusercontent.com/u/20024955?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/zjinlei\",\"html_url\":\"https://github.com/zjinlei\",\"followers_url\":\"https://api.github.com/users/zjinlei/followers\",\"following_url\":\"https://api.github.com/users/zjinlei/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/zjinlei/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/zjinlei/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/zjinlei/subscriptions\",\"organizations_url\":\"https://api.github.com/users/zjinlei/orgs\",\"repos_url\":\"https://api.github.com/users/zjinlei/repos\",\"events_url\":\"https://api.github.com/users/zjinlei/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/zjinlei/received_events\",\"type\":\"User\",\"site_admin\":false},\"parents\":[{\"sha\":\"97dc589d88c96bfa96c6e50ccc5c75fc1bdc9a1b\",\"url\":\"https://api.github.com/repos/seata/seata/commits/97dc589d88c96bfa96c6e50ccc5c75fc1bdc9a1b\",\"html_url\":\"https://github.com/seata/seata/commit/97dc589d88c96bfa96c6e50ccc5c75fc1bdc9a1b\"}]},{\"sha\":\"97dc589d88c96bfa96c6e50ccc5c75fc1bdc9a1b\",\"node_id\":\"MDY6Q29tbWl0MTYzMzg3MzM3Ojk3ZGM1ODlkODhjOTZiZmE5NmM2ZTUwY2NjNWM3NWZjMWJkYzlhMWI=\",\"commit\":{\"author\":{\"name\":\"will\",\"email\":\"349071347@qq.com\",\"date\":\"2019-12-13T03:55:20Z\"},\"committer\":{\"name\":\"zjinlei\",\"email\":\"75718677@qq.com\",\"date\":\"2019-12-13T03:55:20Z\"},\"message\":\"bugfix: fix duplicated table meta cache key (#1929)\",\"tree\":{\"sha\":\"07f0efe633d1f5eb01da21fb72168865c5ecbdac\",\"url\":\"https://api.github.com/repos/seata/seata/git/trees/07f0efe633d1f5eb01da21fb72168865c5ecbdac\"},\"url\":\"https://api.github.com/repos/seata/seata/git/commits/97dc589d88c96bfa96c6e50ccc5c75fc1bdc9a1b\",\"comment_count\":0,\"verification\":{\"verified\":false,\"reason\":\"unsigned\",\"signature\":null,\"payload\":null}},\"url\":\"https://api.github.com/repos/seata/seata/commits/97dc589d88c96bfa96c6e50ccc5c75fc1bdc9a1b\",\"html_url\":\"https://github.com/seata/seata/commit/97dc589d88c96bfa96c6e50ccc5c75fc1bdc9a1b\",\"comments_url\":\"https://api.github.com/repos/seata/seata/commits/97dc589d88c96bfa96c6e50ccc5c75fc1bdc9a1b/comments\",\"author\":{\"login\":\"l81893521\",\"id\":4516752,\"node_id\":\"MDQ6VXNlcjQ1MTY3NTI=\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/4516752?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/l81893521\",\"html_url\":\"https://github.com/l81893521\",\"followers_url\":\"https://api.github.com/users/l81893521/followers\",\"following_url\":\"https://api.github.com/users/l81893521/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/l81893521/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/l81893521/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/l81893521/subscriptions\",\"organizations_url\":\"https://api.github.com/users/l81893521/orgs\",\"repos_url\":\"https://api.github.com/users/l81893521/repos\",\"events_url\":\"https://api.github.com/users/l81893521/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/l81893521/received_events\",\"type\":\"User\",\"site_admin\":false},\"committer\":{\"login\":\"zjinlei\",\"id\":20024955,\"node_id\":\"MDQ6VXNlcjIwMDI0OTU1\",\"avatar_url\":\"https://avatars3.githubusercontent.com/u/20024955?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/zjinlei\",\"html_url\":\"https://github.com/zjinlei\",\"followers_url\":\"https://api.github.com/users/zjinlei/followers\",\"following_url\":\"https://api.github.com/users/zjinlei/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/zjinlei/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/zjinlei/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/zjinlei/subscriptions\",\"organizations_url\":\"https://api.github.com/users/zjinlei/orgs\",\"repos_url\":\"https://api.github.com/users/zjinlei/repos\",\"events_url\":\"https://api.github.com/users/zjinlei/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/zjinlei/received_events\",\"type\":\"User\",\"site_admin\":false},\"parents\":[{\"sha\":\"441c0396b93419dfeab77586686a721b61a89fd6\",\"url\":\"https://api.github.com/repos/seata/seata/commits/441c0396b93419dfeab77586686a721b61a89fd6\",\"html_url\":\"https://github.com/seata/seata/commit/441c0396b93419dfeab77586686a721b61a89fd6\"}]},{\"sha\":\"441c0396b93419dfeab77586686a721b61a89fd6\",\"node_id\":\"MDY6Q29tbWl0MTYzMzg3MzM3OjQ0MWMwMzk2YjkzNDE5ZGZlYWI3NzU4NjY4NmE3MjFiNjFhODlmZDY=\",\"commit\":{\"author\":{\"name\":\"??\",\"email\":\"niao.shuai123@163.com\",\"date\":\"2019-12-13T02:08:06Z\"},\"committer\":{\"name\":\"zjinlei\",\"email\":\"75718677@qq.com\",\"date\":\"2019-12-13T02:08:06Z\"},\"message\":\"container: Add Dockerfile (#1967)\",\"tree\":{\"sha\":\"566ff7aa994ec33d75bcf8c3e439f9611164ab24\",\"url\":\"https://api.github.com/repos/seata/seata/git/trees/566ff7aa994ec33d75bcf8c3e439f9611164ab24\"},\"url\":\"https://api.github.com/repos/seata/seata/git/commits/441c0396b93419dfeab77586686a721b61a89fd6\",\"comment_count\":0,\"verification\":{\"verified\":false,\"reason\":\"unsigned\",\"signature\":null,\"payload\":null}},\"url\":\"https://api.github.com/repos/seata/seata/commits/441c0396b93419dfeab77586686a721b61a89fd6\",\"html_url\":\"https://github.com/seata/seata/commit/441c0396b93419dfeab77586686a721b61a89fd6\",\"comments_url\":\"https://api.github.com/repos/seata/seata/commits/441c0396b93419dfeab77586686a721b61a89fd6/comments\",\"author\":{\"login\":\"niaoshuai\",\"id\":5117373,\"node_id\":\"MDQ6VXNlcjUxMTczNzM=\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/5117373?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/niaoshuai\",\"html_url\":\"https://github.com/niaoshuai\",\"followers_url\":\"https://api.github.com/users/niaoshuai/followers\",\"following_url\":\"https://api.github.com/users/niaoshuai/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/niaoshuai/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/niaoshuai/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/niaoshuai/subscriptions\",\"organizations_url\":\"https://api.github.com/users/niaoshuai/orgs\",\"repos_url\":\"https://api.github.com/users/niaoshuai/repos\",\"events_url\":\"https://api.github.com/users/niaoshuai/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/niaoshuai/received_events\",\"type\":\"User\",\"site_admin\":false},\"committer\":{\"login\":\"zjinlei\",\"id\":20024955,\"node_id\":\"MDQ6VXNlcjIwMDI0OTU1\",\"avatar_url\":\"https://avatars3.githubusercontent.com/u/20024955?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/zjinlei\",\"html_url\":\"https://github.com/zjinlei\",\"followers_url\":\"https://api.github.com/users/zjinlei/followers\",\"following_url\":\"https://api.github.com/users/zjinlei/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/zjinlei/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/zjinlei/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/zjinlei/subscriptions\",\"organizations_url\":\"https://api.github.com/users/zjinlei/orgs\",\"repos_url\":\"https://api.github.com/users/zjinlei/repos\",\"events_url\":\"https://api.github.com/users/zjinlei/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/zjinlei/received_events\",\"type\":\"User\",\"site_admin\":false},\"parents\":[{\"sha\":\"b4c421800904bbfb591c0aa5129894bb1d954d8c\",\"url\":\"https://api.github.com/repos/seata/seata/commits/b4c421800904bbfb591c0aa5129894bb1d954d8c\",\"html_url\":\"https://github.com/seata/seata/commit/b4c421800904bbfb591c0aa5129894bb1d954d8c\"}]},{\"sha\":\"b4c421800904bbfb591c0aa5129894bb1d954d8c\",\"node_id\":\"MDY6Q29tbWl0MTYzMzg3MzM3OmI0YzQyMTgwMDkwNGJiZmI1OTFjMGFhNTEyOTg5NGJiMWQ5NTRkOGM=\",\"commit\":{\"author\":{\"name\":\"ph3636\",\"email\":\"38041490+ph3636@users.noreply.github.com\",\"date\":\"2019-12-12T10:36:48Z\"},\"committer\":{\"name\":\"xingfudeshi\",\"email\":\"xingfudeshi@vip.qq.com\",\"date\":\"2019-12-12T10:36:48Z\"},\"message\":\" optimize: optimize about ConfigFuture (#2018)\",\"tree\":{\"sha\":\"5f7b6ae136961949eb1165151530e8eb412cf58a\",\"url\":\"https://api.github.com/repos/seata/seata/git/trees/5f7b6ae136961949eb1165151530e8eb412cf58a\"},\"url\":\"https://api.github.com/repos/seata/seata/git/commits/b4c421800904bbfb591c0aa5129894bb1d954d8c\",\"comment_count\":0,\"verification\":{\"verified\":false,\"reason\":\"unsigned\",\"signature\":null,\"payload\":null}},\"url\":\"https://api.github.com/repos/seata/seata/commits/b4c421800904bbfb591c0aa5129894bb1d954d8c\",\"html_url\":\"https://github.com/seata/seata/commit/b4c421800904bbfb591c0aa5129894bb1d954d8c\",\"comments_url\":\"https://api.github.com/repos/seata/seata/commits/b4c421800904bbfb591c0aa5129894bb1d954d8c/comments\",\"author\":{\"login\":\"ph3636\",\"id\":38041490,\"node_id\":\"MDQ6VXNlcjM4MDQxNDkw\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/38041490?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ph3636\",\"html_url\":\"https://github.com/ph3636\",\"followers_url\":\"https://api.github.com/users/ph3636/followers\",\"following_url\":\"https://api.github.com/users/ph3636/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ph3636/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ph3636/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ph3636/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ph3636/orgs\",\"repos_url\":\"https://api.github.com/users/ph3636/repos\",\"events_url\":\"https://api.github.com/users/ph3636/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ph3636/received_events\",\"type\":\"User\",\"site_admin\":false},\"committer\":{\"login\":\"xingfudeshi\",\"id\":24457941,\"node_id\":\"MDQ6VXNlcjI0NDU3OTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/24457941?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/xingfudeshi\",\"html_url\":\"https://github.com/xingfudeshi\",\"followers_url\":\"https://api.github.com/users/xingfudeshi/followers\",\"following_url\":\"https://api.github.com/users/xingfudeshi/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/xingfudeshi/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/xingfudeshi/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/xingfudeshi/subscriptions\",\"organizations_url\":\"https://api.github.com/users/xingfudeshi/orgs\",\"repos_url\":\"https://api.github.com/users/xingfudeshi/repos\",\"events_url\":\"https://api.github.com/users/xingfudeshi/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/xingfudeshi/received_events\",\"type\":\"User\",\"site_admin\":false},\"parents\":[{\"sha\":\"8e0ab02d6ff38219d47aa5e49d0deb0358be6190\",\"url\":\"https://api.github.com/repos/seata/seata/commits/8e0ab02d6ff38219d47aa5e49d0deb0358be6190\",\"html_url\":\"https://github.com/seata/seata/commit/8e0ab02d6ff38219d47aa5e49d0deb0358be6190\"}]}]\n";

        List<Commits> commits = new Gson().fromJson(str, new TypeToken<List<Commits>>() {}.getType());
        System.out.println(JSON.toJSON(commits));
    }
}
